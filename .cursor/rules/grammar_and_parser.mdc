---
description: Use when adding any new language features or modifying existing ones that require syntax changes
globs: 
alwaysApply: false
---
# Modifying Language Grammar and Regenerating Parser

When making changes to the Manuscript language syntax:

1.  **Update Grammar Files**:
    *   Modify the parser grammar rules in `[Manuscript.g4](mdc:internal/grammar/Manuscript.g4)`.
    *   If new keywords or token types are needed, update the lexer rules in `[ManuscriptLexer.g4](mdc:internal/grammar/ManuscriptLexer.g4)`. Remember that token order in the lexer can be significant.

2.  **Regenerate Parser**:
    *   After any changes to `.g4` files, you **must** regenerate the parser.
    *   Run the command: `make generate_parser` from the workspace root.

3.  **Do Not Edit Generated Parser**:
    *   The code in the `internal/parser/` directory, especially `[manuscript_parser.go](mdc:internal/parser/manuscript_parser.go)`, is auto-generated by ANTLR.
    *   **Never** edit files in `internal/parser/` directly, as your changes will be overwritten the next time the parser is regenerated.
